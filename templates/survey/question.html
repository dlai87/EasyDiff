{% extends "base.html" %}

{% block title %}Question {{ current_set }} - {{ study.name }}{% endblock %}

{% block navbar %}{% endblock %}

{% block content %}
<div class="survey-container">
    {% if is_preview %}
    <div class="alert alert-warning mb-4">
        <strong>Preview Mode</strong> - Responses will not be saved to results.
    </div>
    {% endif %}

    <div class="survey-header">
        <h1 class="text-lg font-semibold">{{ study.name }}</h1>
    </div>

    <div class="survey-progress">
        <div class="survey-progress-text">
            Question {{ current_set }} of {{ total_sets }}
        </div>
        <div class="progress">
            <div class="progress-bar" style="width: {{ (current_set / total_sets) * 100 }}%"></div>
        </div>
    </div>

    <div class="survey-question">
        <div class="survey-instruction">
            <p>{{ study.question_text }}</p>
        </div>

        <form method="POST" action="{{ url_for('survey_question', token=token) }}" id="survey-form">
            <input type="hidden" name="best" id="best-input" value="">
            <input type="hidden" name="worst" id="worst-input" value="">

            <div class="survey-items">
                {% for item in items %}
                    <div class="survey-item">
                        <button type="button"
                                class="survey-btn survey-btn-best"
                                data-item-id="{{ item.id }}">
                            {{ study.best_label }}
                        </button>
                        <div class="survey-item-content">
                            <span class="survey-item-name">{{ item.name }}</span>
                            {% if item.description %}
                                <span class="survey-item-description">{{ item.description }}</span>
                            {% endif %}
                        </div>
                        <button type="button"
                                class="survey-btn survey-btn-worst"
                                data-item-id="{{ item.id }}">
                            {{ study.worst_label }}
                        </button>
                    </div>
                {% endfor %}
            </div>

            <div class="survey-submit">
                <button type="submit" id="survey-submit" class="btn btn-primary btn-lg w-full" disabled>
                    {% if current_set < total_sets %}
                        Next Question
                    {% else %}
                        Submit Survey
                    {% endif %}
                </button>
                <p class="survey-submit-hint" id="submit-hint">
                    Please select both {{ study.best_label }} and {{ study.worst_label }} to continue
                </p>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block footer %}{% endblock %}
